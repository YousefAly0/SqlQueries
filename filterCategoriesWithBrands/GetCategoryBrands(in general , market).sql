
--get all category brands
SELECT [t0].[pl_id] AS [Id], [t0].[pl_name] AS [Name], [t0].[br_img_imgurl] AS [PhotoUrl]
      FROM (
          SELECT DISTINCT [t].[pl_id], [t].[pl_name], [t].[br_img_imgurl]
          FROM [Item_Type] AS [i]
          INNER JOIN (
              SELECT [p0].[pl_id], [p0].[pl_name], [b].[br_img_imgurl], [p].[pl_prim_type]
              FROM [productLines] AS [p]
              LEFT JOIN [productLines] AS [p0] ON [p].[pl_parent] = [p0].[pl_id]
              LEFT JOIN [BrandsImage] AS [b] ON [p0].[pl_id] = [b].[br_img_pl_id]
          ) AS [t] ON [i].[type_id] = [t].[pl_prim_type]
          WHERE [i].[type_id] IN (CAST(10200416 AS bigint), CAST(10200841 AS bigint), CAST(10201415 AS bigint), CAST(10200131 AS bigint), CAST(10200134 AS bigint), CAST(10200135 AS bigint), CAST(10200158 AS bigint), CAST(10200392 AS bigint), CAST(10200725 AS bigint), CAST(10200831 AS bigint), CAST(10200836 AS bigint), CAST(10200839 AS bigint), CAST(10201380 AS bigint), CAST(10200609 AS bigint), CAST(10200891 AS bigint), CAST(10200165 AS bigint), CAST(10200166 AS bigint), CAST(10200167 AS bigint), CAST(10201153 AS bigint), CAST(10200245 AS bigint), CAST(10200373 AS bigint), CAST(10200374 AS bigint), CAST(10200375 AS bigint), CAST(10200548 AS bigint), CAST(10200549 AS bigint), CAST(10200550 AS bigint), CAST(10200552 AS bigint), CAST(10200606 AS bigint), CAST(10201032 AS bigint), CAST(10201033 AS bigint), CAST(10201034 AS bigint), CAST(10201035 AS bigint), CAST(10201036 AS bigint), CAST(10201351 AS bigint), CAST(10201370 AS bigint), CAST(10201372 AS bigint), CAST(17860020 AS bigint), CAST(10200729 AS bigint), CAST(10201363 AS bigint), CAST(10200327 AS bigint), CAST(17860050 AS bigint), CAST(17860051 AS bigint), CAST(17860053 AS bigint), CAST(10200138 AS bigint), CAST(10200140 AS bigint), CAST(10200141 AS bigint), CAST(10200142 AS bigint), CAST(10200143 AS bigint), CAST(10201379 AS bigint), CAST(10200195 AS bigint), CAST(10200196 AS bigint), CAST(10200198 AS bigint), CAST(10200199 AS bigint), CAST(10200200 AS bigint), CAST(10200201 AS bigint), CAST(10200203 AS bigint), CAST(10200546 AS bigint), CAST(10200834 AS bigint), CAST(10201104 AS bigint), CAST(10201150 AS bigint), CAST(17860031 AS bigint), CAST(10200168 AS bigint), CAST(10200169 AS bigint), CAST(10200170 AS bigint), CAST(10200171 AS bigint), CAST(10201262 AS bigint), CAST(10201272 AS bigint), CAST(10200400 AS bigint), CAST(10200777 AS bigint), CAST(10200826 AS bigint), CAST(10201106 AS bigint), CAST(10201123 AS bigint), CAST(10201158 AS bigint), CAST(17860030 AS bigint), CAST(10200153 AS bigint), CAST(10200361 AS bigint), CAST(10200364 AS bigint), CAST(10200365 AS bigint), CAST(10200367 AS bigint), CAST(10200368 AS bigint), CAST(10200369 AS bigint), CAST(10200394 AS bigint), CAST(10200423 AS bigint), CAST(10200465 AS bigint), CAST(10200670 AS bigint), CAST(10200995 AS bigint), CAST(10201003 AS bigint), CAST(10201004 AS bigint), CAST(10201127 AS bigint), CAST(10201349 AS bigint), CAST(10201373 AS bigint), CAST(10201484 AS bigint), CAST(17860034 AS bigint), CAST(10200188 AS bigint), CAST(10200429 AS bigint), CAST(10200431 AS bigint), CAST(10200432 AS bigint), CAST(10200434 AS bigint), CAST(10200435 AS bigint), CAST(10200436 AS bigint), CAST(10200622 AS bigint), CAST(10200999 AS bigint), CAST(10201001 AS bigint), CAST(10201002 AS bigint), CAST(10201105 AS bigint), CAST(10201126 AS bigint), CAST(10201190 AS bigint), CAST(10201448 AS bigint), CAST(10201487 AS bigint), CAST(10200350 AS bigint), CAST(10200353 AS bigint), CAST(10200355 AS bigint), CAST(10200459 AS bigint), CAST(10200467 AS bigint), CAST(10200530 AS bigint), CAST(17860033 AS bigint), CAST(10200551 AS bigint), CAST(10200661 AS bigint), CAST(10200778 AS bigint), CAST(10201128 AS bigint), CAST(10201231 AS bigint), CAST(10201381 AS bigint), CAST(10201387 AS bigint), CAST(10201440 AS bigint), CAST(10201450 AS bigint), CAST(10200147 AS bigint), CAST(10200149 AS bigint), CAST(10200413 AS bigint), CAST(10200456 AS bigint), CAST(10200457 AS bigint), CAST(10200529 AS bigint), CAST(10200621 AS bigint), CAST(10200640 AS bigint), CAST(10200827 AS bigint), CAST(10200985 AS bigint), CAST(10201037 AS bigint), CAST(10201141 AS bigint), CAST(10201142 AS bigint), CAST(10201143 AS bigint), CAST(10201149 AS bigint), CAST(10201155 AS bigint), CAST(10201172 AS bigint), CAST(10201187 AS bigint), CAST(10201211 AS bigint), CAST(17860004 AS bigint), CAST(17860005 AS bigint), CAST(10200174 AS bigint), CAST(10200175 AS bigint), CAST(10200176 AS bigint), CAST(10200458 AS bigint), CAST(10200545 AS bigint), CAST(10200973 AS bigint), CAST(10200994 AS bigint), CAST(10201098 AS bigint), CAST(10201277 AS bigint), CAST(10400001 AS bigint), CAST(17860014 AS bigint), CAST(17860032 AS bigint), CAST(10201125 AS bigint), CAST(10201464 AS bigint), CAST(10201022 AS bigint), CAST(10201027 AS bigint), CAST(10201039 AS bigint), CAST(10201481 AS bigint), CAST(10201199 AS bigint), CAST(10201461 AS bigint), CAST(17860023 AS bigint))
      ) AS [t0]
      ORDER BY [t0].[pl_id]
      OFFSET 0 ROWS FETCH NEXT 10000 ROWS ONLY


	  --get all category brands in a specific market

	  SELECT [t0].[pl_id] AS [Id], [t0].[pl_name] AS [Name], [t0].[br_img_imgurl] AS [PhotoUrl]
      FROM (
          SELECT DISTINCT [t].[pl_id], [t].[pl_name], [t].[br_img_imgurl]
          FROM [Item_Type] AS [i]
          INNER JOIN (
              SELECT [p0].[pl_id], [p0].[pl_name], [b].[br_img_imgurl], [p].[pl_prim_type]
              FROM [productLines] AS [p]
              LEFT JOIN [productLines] AS [p0] ON [p].[pl_parent] = [p0].[pl_id]
              LEFT JOIN [BrandsImage] AS [b] ON [p0].[pl_id] = [b].[br_img_pl_id]
          ) AS [t] ON [i].[type_id] = [t].[pl_prim_type]
          WHERE [i].[type_id] IN (CAST(10200416 AS bigint), CAST(10200841 AS bigint), CAST(10201415 AS bigint), CAST(10200131 AS bigint), CAST(10200134 AS bigint), CAST(10200135 AS bigint), CAST(10200158 AS bigint), CAST(10200392 AS bigint), CAST(10200725 AS bigint), CAST(10200831 AS bigint), CAST(10200836 AS bigint), CAST(10200839 AS bigint), CAST(10201380 AS bigint), CAST(10200609 AS bigint), CAST(10200891 AS bigint), CAST(10200165 AS bigint), CAST(10200166 AS bigint), CAST(10200167 AS bigint), CAST(10201153 AS bigint), CAST(10200245 AS bigint), CAST(10200373 AS bigint), CAST(10200374 AS bigint), CAST(10200375 AS bigint), CAST(10200548 AS bigint), CAST(10200549 AS bigint), CAST(10200550 AS bigint), CAST(10200552 AS bigint), CAST(10200606 AS bigint), CAST(10201032 AS bigint), CAST(10201033 AS bigint), CAST(10201034 AS bigint), CAST(10201035 AS bigint), CAST(10201036 AS bigint), CAST(10201351 AS bigint), CAST(10201370 AS bigint), CAST(10201372 AS bigint), CAST(17860020 AS bigint), CAST(10200729 AS bigint), CAST(10201363 AS bigint), CAST(10200327 AS bigint), CAST(17860050 AS bigint), CAST(17860051 AS bigint), CAST(17860053 AS bigint), CAST(10200138 AS bigint), CAST(10200140 AS bigint), CAST(10200141 AS bigint), CAST(10200142 AS bigint), CAST(10200143 AS bigint), CAST(10201379 AS bigint), CAST(10200195 AS bigint), CAST(10200196 AS bigint), CAST(10200198 AS bigint), CAST(10200199 AS bigint), CAST(10200200 AS bigint), CAST(10200201 AS bigint), CAST(10200203 AS bigint), CAST(10200546 AS bigint), CAST(10200834 AS bigint), CAST(10201104 AS bigint), CAST(10201150 AS bigint), CAST(17860031 AS bigint), CAST(10200168 AS bigint), CAST(10200169 AS bigint), CAST(10200170 AS bigint), CAST(10200171 AS bigint), CAST(10201262 AS bigint), CAST(10201272 AS bigint), CAST(10200400 AS bigint), CAST(10200777 AS bigint), CAST(10200826 AS bigint), CAST(10201106 AS bigint), CAST(10201123 AS bigint), CAST(10201158 AS bigint), CAST(17860030 AS bigint), CAST(10200153 AS bigint), CAST(10200361 AS bigint), CAST(10200364 AS bigint), CAST(10200365 AS bigint), CAST(10200367 AS bigint), CAST(10200368 AS bigint), CAST(10200369 AS bigint), CAST(10200394 AS bigint), CAST(10200423 AS bigint), CAST(10200465 AS bigint), CAST(10200670 AS bigint), CAST(10200995 AS bigint), CAST(10201003 AS bigint), CAST(10201004 AS bigint), CAST(10201127 AS bigint), CAST(10201349 AS bigint), CAST(10201373 AS bigint), CAST(10201484 AS bigint), CAST(17860034 AS bigint), CAST(10200188 AS bigint), CAST(10200429 AS bigint), CAST(10200431 AS bigint), CAST(10200432 AS bigint), CAST(10200434 AS bigint), CAST(10200435 AS bigint), CAST(10200436 AS bigint), CAST(10200622 AS bigint), CAST(10200999 AS bigint), CAST(10201001 AS bigint), CAST(10201002 AS bigint), CAST(10201105 AS bigint), CAST(10201126 AS bigint), CAST(10201190 AS bigint), CAST(10201448 AS bigint), CAST(10201487 AS bigint), CAST(10200350 AS bigint), CAST(10200353 AS bigint), CAST(10200355 AS bigint), CAST(10200459 AS bigint), CAST(10200467 AS bigint), CAST(10200530 AS bigint), CAST(17860033 AS bigint), CAST(10200551 AS bigint), CAST(10200661 AS bigint), CAST(10200778 AS bigint), CAST(10201128 AS bigint), CAST(10201231 AS bigint), CAST(10201381 AS bigint), CAST(10201387 AS bigint), CAST(10201440 AS bigint), CAST(10201450 AS bigint), CAST(10200147 AS bigint), CAST(10200149 AS bigint), CAST(10200413 AS bigint), CAST(10200456 AS bigint), CAST(10200457 AS bigint), CAST(10200529 AS bigint), CAST(10200621 AS bigint), CAST(10200640 AS bigint), CAST(10200827 AS bigint), CAST(10200985 AS bigint), CAST(10201037 AS bigint), CAST(10201141 AS bigint), CAST(10201142 AS bigint), CAST(10201143 AS bigint), CAST(10201149 AS bigint), CAST(10201155 AS bigint), CAST(10201172 AS bigint), CAST(10201187 AS bigint), CAST(10201211 AS bigint), CAST(17860004 AS bigint), CAST(17860005 AS bigint), CAST(10200174 AS bigint), CAST(10200175 AS bigint), CAST(10200176 AS bigint), CAST(10200458 AS bigint), CAST(10200545 AS bigint), CAST(10200973 AS bigint), CAST(10200994 AS bigint), CAST(10201098 AS bigint), CAST(10201277 AS bigint), CAST(10400001 AS bigint), CAST(17860014 AS bigint), CAST(17860032 AS bigint), CAST(10201125 AS bigint), CAST(10201464 AS bigint), CAST(10201022 AS bigint), CAST(10201027 AS bigint), CAST(10201039 AS bigint), CAST(10201481 AS bigint), CAST(10201199 AS bigint), CAST(10201461 AS bigint), CAST(17860023 AS bigint)) AND EXISTS (
              SELECT 1
              FROM [productLines] AS [p1]
              WHERE ([i].[type_id] = [p1].[pl_prim_type]) AND EXISTS (
                  SELECT 1
                  FROM [excelproducts] AS [e]
                  WHERE ((([e].[ep_disable_pr_inapp] <> CAST(1 AS tinyint)) OR [e].[ep_disable_pr_inapp] IS NULL) AND ([p1].[pl_id] = [e].[ep_productLine])) AND EXISTS (
                      SELECT 1
                      FROM [market_products_prices] AS [m]
                      WHERE ([e].[ep_id] = [m].[markpr_pr_id]) AND ([m].[markpr_market_id] = 1))))
      ) AS [t0]
      ORDER BY [t0].[pl_id]
      OFFSET 0 ROWS FETCH NEXT 10000 ROWS ONLY

